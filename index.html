<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card√°pio Inteligente v12</title>
    <style>
        :root { --primary: #4CAF50; --bg: #f4f4f9; --text: #333; --accent: #ff9800; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 10px; color: var(--text); }
        .container { max-width: 1100px; margin: 0 auto; background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .nav-tabs { display: flex; gap: 5px; margin-bottom: 15px; background: #eee; padding: 5px; border-radius: 10px; flex-wrap: wrap; }
        .tab { flex: 1; min-width: 80px; padding: 12px 5px; text-align: center; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 12px; transition: 0.3s; }
        .tab.active { background: var(--primary); color: white; }
        
        .table-wrapper { width: 100%; overflow-x: auto; margin-top: 15px; border: 1px solid #ddd; border-radius: 10px; }
        table { width: 100%; border-collapse: collapse; min-width: 1000px; }
        th { background: var(--primary); color: white; padding: 10px; font-size: 0.8em; }
        td { padding: 8px; border: 1px solid #eee; font-size: 0.75em; vertical-align: top; }
        .ref-header { background: #f1f1f1; font-weight: bold; width: 80px; position: sticky; left: 0; }
        .hoje-col { background: #e8f5e9; border: 2px solid var(--primary) !important; }

        .bloco { border-left: 5px solid var(--primary); background: #f9f9f9; padding: 12px; margin-bottom: 12px; border-radius: 5px; }
        .bloco h3 { margin: 0 0 5px 0; font-size: 0.85em; color: #666; text-transform: uppercase; }
        .ing-item { background: #fff; border: 1px solid #ddd; padding: 10px; margin-bottom: 10px; border-radius: 5px; }
        .ing-item b { color: var(--primary); display: block; margin-bottom: 5px; }
        .lista-compras { columns: 2; -webkit-columns: 2; list-style: none; padding: 0; }
        .lista-compras li { padding: 4px 0; font-size: 0.9em; border-bottom: 1px solid #eee; }
        .opcional { color: #d32f2f; font-weight: bold; font-size: 0.8em; display: block; margin-top: 3px; }
    </style>
</head>
<body>

<div class="container">
    <div class="nav-tabs">
        <div class="tab active" onclick="app.mudarAba('dia', this)">Hoje</div>
        <div class="tab" onclick="app.mudarAba('semana', this)">Tabela</div>
        <div class="tab" onclick="app.mudarAba('receitas', this)">Receitas</div>
        <div class="tab" onclick="app.mudarAba('compras', this)">Compras</div>
    </div>
    <div id="conteudo-principal">Carregando card√°pio v12...</div>
</div>

<script>
const app = {
    banco: {
        cafe: [
            { txt: "P√£o com ovo", cat: "pao", ing: ["P√£o franc√™s", "Ovos", "Manteiga"] },
            { txt: "P√£o com manteiga", cat: "pao", ing: ["P√£o franc√™s", "Manteiga"] },
            { txt: "Mingau de tapioca", cat: "liq", ing: ["Tapioca granulada", "Leite", "Coco", "A√ß√∫car"] },
            { txt: "Mingau de milho", cat: "liq", ing: ["Milho", "Leite", "Canela"] },
            { txt: "Cuscuz com ovo", cat: "cuscuz", ing: ["Farinha de milho", "Ovos", "Manteiga"] },
            { txt: "P√£o com queijo e presunto", cat: "pao", ing: ["P√£o", "Queijo", "Presunto"] },
            { txt: "Banana da terra cozida", cat: "cozido", ing: ["Banana da terra"] },
            { txt: "P√£o com pat√™ de frango", cat: "pao", ing: ["P√£o", "Frango desfiado", "Maionese"] },
            { txt: "Torrada com pat√™ de atum", cat: "torrada", ing: ["Torrada", "Atum em lata", "Maionese"] }
        ],
        almoco: {
            arroz: ["Arroz Branco", "Arroz com Cenoura"],
            feijoes: ["Feij√£o carioca", "Feij√£o preto", "Feij√£o fradinho"],
            proteinas: ["Frango assado", "Carne mo√≠da", "F√≠gado acebolado", "Bife no molho", "Peixe frito", "Alm√¥ndega"],
            acompa: ["Pur√© de batata", "Salada de maionese", "Farofa de ovos", "Couve refogada", "Creme de milho", "Vinagrete"],
            sucos: ["Maracuj√°", "Laranja", "Abacaxi", "Lim√£o"],
            sobremesas: ["Gelatina", "Pudim", "Mousse de maracuj√°"],
            ing: {
                "Arroz Branco": ["Arroz", "Alho"], "Arroz com Cenoura": ["Arroz", "Cenoura"],
                "Feij√£o carioca": ["Feij√£o carioca", "Louro"], "Feij√£o preto": ["Feij√£o preto", "Alho"],
                "Frango assado": ["Sobrecoxa de frango", "Tempero"], "Carne mo√≠da": ["Carne mo√≠da", "Tomate"],
                "F√≠gado acebolado": ["F√≠gado", "Cebola"], "Pur√© de batata": ["Batata", "Leite", "Manteiga"],
                "Salada de maionese": ["Batata", "Cenoura", "Maionese"], "Farofa de ovos": ["Farinha", "Ovos"]
            }
        },
        jantar: [
            { txt: "Arroz com ovo", cat: "sol", ing: ["Arroz", "Ovos"] },
            { txt: "Sopa de legumes", cat: "liq", ing: ["Legumes variados", "Macarr√£o"] },
            { txt: "Pizza", cat: "sol", ing: ["Massa de pizza", "Queijo", "Molho"] },
            { txt: "Hamb√∫rguer", cat: "sol", ing: ["P√£o de hamb√∫rguer", "Carne", "Queijo"] }
        ],
        bebidas: ["Caf√©", "Leite com chocolate", "Ch√°", "Suco"],
        lanchesM: ["Banana", "Ma√ß√£", "Uva", "Melancia", "Pera"],
        lanchesT: ["Iogurte", "Bolo Caseiro", "P√£o de Queijo", "Pipoca"]
    },

    escolher(lista) { return lista[Math.floor(Math.random() * lista.length)]; },

    gerarTudo() {
        let plano = [];
        const dias = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        for (let s = 0; s < 12; s++) {
            let semana = {};
            let dCafe = [...this.banco.cafe], dLM = [...this.banco.lanchesM], dLT = [...this.banco.lanchesT], dJan = [...this.banco.jantar];
            
            dias.forEach(d => {
                const itemC = dCafe.splice(Math.floor(Math.random()*dCafe.length),1)[0] || this.banco.cafe[0];
                const bebUnica = itemC.cat === "liq" ? "" : "‚Ä¢ " + this.escolher(this.banco.bebidas);
                const prot = (d === "S√ÅBADO" || d === "DOMINGO") ? this.banco.almoco.proteinas.filter(p=>!p.includes("F√≠gado"))[0] : this.escolher(this.banco.almoco.proteinas);
                const arroz = this.escolher(this.banco.almoco.arroz);
                const feijao = this.escolher(this.banco.almoco.feijoes);
                const acompanhamento = this.escolher(this.banco.almoco.acompa);
                const itemJ = dJan.splice(Math.floor(Math.random()*dJan.length),1)[0] || this.banco.jantar[0];

                semana[d] = {
                    cafe: { txt: `${itemC.txt}<br>${bebUnica}`, ing: itemC.ing, obs: itemC.txt.match(/Tapioca|Mingau/i) ? "<span class='opcional'>Op√ß√£o 2: P√£o com Caf√©</span>" : "" },
                    lancheM: dLM.splice(Math.floor(Math.random()*dLM.length),1)[0],
                    almoco: { 
                        txt: `‚Ä¢ ${arroz}<br>‚Ä¢ ${feijao}<br>‚Ä¢ ${prot}<br>‚Ä¢ ${acompanhamento}<br>‚Ä¢ ü•§ Suco`, 
                        ing: [...(this.banco.almoco.ing[arroz]||[]), ...(this.banco.almoco.ing[feijao]||[]), ...(this.banco.almoco.ing[prot]||[]), ...(this.banco.almoco.ing[acompanhamento]||[])],
                        sob: (d==="S√ÅBADO"||d==="DOMINGO") ? "üçÆ " + this.escolher(this.banco.almoco.sobremesas) : ""
                    },
                    lancheT: dLT.splice(Math.floor(Math.random()*dLT.length),1)[0],
                    jantar: { txt: `${itemJ.txt}<br>${itemJ.cat==="liq"?"":"‚Ä¢ ü•§ Suco"}`, ing: itemJ.ing, obs: itemJ.txt.match(/Sopa|Caldo/i) ? "<span class='opcional'>Op√ß√£o 2: P√£o com Ovo</span>" : "" }
                };
            });
            plano.push(semana);
        }
        localStorage.setItem("plano", JSON.stringify(plano));
        localStorage.setItem("v", "12.0");
        return plano;
    },

    mudarAba(aba, el) {
        if(el) { document.querySelectorAll('.tab').forEach(t => t.classList.remove('active')); el.classList.add('active'); }
        const container = document.getElementById("conteudo-principal");
        if (!localStorage.getItem("plano")) this.gerarTudo();
        const data = JSON.parse(localStorage.getItem("plano"))[0];
        const hojeIdx = new Date().getDay() === 0 ? 6 : new Date().getDay() - 1;
        const diasArr = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        const dHoje = data[diasArr[hojeIdx]];

        if (aba === 'dia') {
            container.innerHTML = `<div class="bloco"><h3>‚òï Caf√©</h3>${dHoje.cafe.txt}${dHoje.cafe.obs}</div><div class="bloco"><h3>üçé Lanche M</h3>${dHoje.lancheM}</div><div class="bloco"><h3>üçõ Almo√ßo</h3>${dHoje.almoco.txt}<br><b>${dHoje.almoco.sob}</b></div><div class="bloco"><h3>üç™ Lanche T</h3>${dHoje.lancheT}</div><div class="bloco"><h3>üåô Jantar</h3>${dHoje.jantar.txt}${dHoje.jantar.obs}</div>`;
        } else if (aba === 'semana') {
            let html = `<div class="table-wrapper"><table><tr><th class="ref-header">Refei√ß√£o</th>`;
            diasArr.forEach((d, i) => html += `<th class="${i===hojeIdx?'hoje-col':''}">${d}</th>`);
            const refs = [{l:"Caf√©",k:"cafe"},{l:"Lanche M",k:"lancheM"},{l:"Almo√ßo",k:"almoco"},{l:"Lanche T",k:"lancheT"},{l:"Jantar",k:"jantar"}];
            refs.forEach(r => {
                html += `<tr><td class="ref-header">${r.l}</td>`;
                diasArr.forEach((d, i) => {
                    let val = data[d][r.k];
                    html += `<td class="${i===hojeIdx?'hoje-col':''}">${val.txt || val} ${val.obs || ""}</td>`;
                });
                html += `</tr>`;
            });
            container.innerHTML = html + `</table></div>`;
        } else if (aba === 'receitas') {
            container.innerHTML = `<h2>Ingredientes de Hoje (${diasArr[hojeIdx]})</h2>` + 
                `<div class="ing-item"><b>Caf√©:</b> ${dHoje.cafe.ing.join(", ")}</div>` +
                `<div class="ing-item"><b>Almo√ßo:</b> ${dHoje.almoco.ing.join(", ")}</div>` +
                `<div class="ing-item"><b>Jantar:</b> ${dHoje.jantar.ing.join(", ")}</div>`;
        } else {
            let todos = [];
            diasArr.forEach(d => { 
                todos = todos.concat(data[d].cafe.ing, data[d].almoco.ing, data[d].jantar.ing);
                todos.push(data[d].lancheM);
                todos.push(data[d].lancheT);
            });
            let lista = [...new Set(todos)].sort();
            container.innerHTML = `<h2>Lista de Compras da Semana</h2><ul class="lista-compras">` + lista.map(i => `<li>${i}</li>`).join("") + `</ul>`;
        }
    }
};
window.onload = () => app.mudarAba('dia');
</script>
</body>
</html>

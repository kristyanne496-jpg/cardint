<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card√°pio Inteligente v14</title>
    <style>
        :root { --primary: #4CAF50; --bg: #f4f4f9; --text: #333; --accent: #ff9800; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 10px; color: var(--text); line-height: 1.4; }
        .container { max-width: 1100px; margin: 0 auto; background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        
        .nav-tabs { display: flex; gap: 5px; margin-bottom: 20px; background: #eee; padding: 5px; border-radius: 10px; }
        .tab { flex: 1; padding: 12px 5px; text-align: center; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 13px; border: none; background: none; }
        .tab.active { background: var(--primary); color: white; }

        .bloco { border-left: 5px solid var(--primary); background: #f9f9f9; padding: 15px; margin-bottom: 12px; border-radius: 5px; position: relative; }
        .bloco h3 { margin: 0 0 5px 0; font-size: 0.85em; color: #666; text-transform: uppercase; }
        
        /* Estilo para edi√ß√£o */
        .editavel { border: 1px dashed #ccc; padding: 10px; background: white; border-radius: 5px; min-height: 40px; outline: none; transition: 0.3s; }
        .editavel:focus { border-color: var(--primary); background: #f0fff0; }
        .aviso-edit { font-size: 10px; color: #999; display: block; margin-top: 5px; }

        .table-wrapper { width: 100%; overflow-x: auto; border: 1px solid #ddd; border-radius: 10px; }
        table { width: 100%; border-collapse: collapse; min-width: 950px; }
        th { background: var(--primary); color: white; padding: 10px; font-size: 11px; }
        td { padding: 10px; border: 1px solid #eee; font-size: 11px; vertical-align: top; background: white; }
        .hoje-col { background: #e8f5e9 !important; font-weight: bold; border: 2px solid var(--primary) !important; }
        
        .compras-item { display: inline-block; background: #eee; padding: 5px 10px; margin: 3px; border-radius: 15px; font-size: 12px; }
    </style>
</head>
<body>

<div class="container">
    <div class="nav-tabs">
        <button class="tab active" onclick="app.mudarAba('dia', this)">Hoje</button>
        <button class="tab" onclick="app.mudarAba('semana', this)">Tabela</button>
        <button class="tab" onclick="app.mudarAba('receitas', this)">Ingredientes</button>
        <button class="tab" onclick="app.mudarAba('compras', this)">Compras</button>
    </div>
    <div id="conteudo-principal">Sincronizando card√°pio v14...</div>
</div>

<script>
const app = {
    banco: {
        cafe: [
            { t: "P√£o com ovo", c: "sol", i: "P√£o, Ovos, Manteiga" },
            { t: "P√£o com manteiga", c: "sol", i: "P√£o franc√™s, Manteiga" },
            { t: "Mingau de tapioca", c: "liq", i: "Tapioca granulada, Leite, A√ß√∫car" },
            { t: "Mingau de milho", c: "liq", i: "Milho, Leite, Canela" },
            { t: "Cuscuz com ovo", c: "sol", i: "Floc√£o de milho, Ovos, Manteiga" },
            { t: "P√£o com queijo e presunto", c: "sol", i: "P√£o, Queijo, Presunto" },
            { t: "Aipim cozido", c: "sol", i: "Aipim, Sal, Manteiga" },
            { t: "Batata doce cozida", c: "sol", i: "Batata doce" },
            { t: "Tapioca com coco", c: "sol", i: "Goma de tapioca, Coco ralado" }
        ],
        almoco: {
            arroz: ["Arroz Branco", "Arroz com Cenoura"],
            feijoes: ["Feij√£o carioca", "Feij√£o preto", "Feij√£o fradinho"],
            proteinas: ["Frango assado", "Carne mo√≠da", "Bife no molho", "Peixe frito", "F√≠gado acebolado", "Alm√¥ndegas"],
            acompa: ["Pur√© de batata", "Salada de maionese", "Couve refogada", "Farofa", "Creme de milho", "Vinagrete"]
        },
        jantar: [
            { t: "Sopa de legumes", c: "liq", i: "Legumes, Macarr√£o" },
            { t: "Arroz com ovo", c: "sol", i: "Arroz, Ovos" },
            { t: "Pizza caseira", c: "sol", i: "Massa, Queijo, Molho" },
            { t: "Cuscuz temperado", c: "sol", i: "Milho, Calabresa, Ovos" },
            { t: "Tapioca de frango", c: "sol", i: "Goma, Frango desfiado" },
            { t: "Hamb√∫rguer", c: "sol", i: "P√£o, Carne, Alface" },
            { t: "Caldo de canoa", c: "liq", i: "Aipim, Carne seca" }
        ],
        bebidasCafe: ["Caf√© puro", "Leite", "Ch√° de Capim Santo", "Suco de Laranja"],
        lanchesM: ["Banana", "Ma√ß√£", "Uva", "Melancia", "Pera", "Morango", "Manga", "Abacaxi", "Kiwi"],
        lanchesT: ["Iogurte Natural", "Bolo de Cenoura", "P√£o de Queijo", "Pipoca", "Sandu√≠che Natural", "Vitamina", "Bolacha Maria", "Salada de Frutas"]
    },

    shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[array[j]]] = [array[j], array[i]];
        }
        return array;
    },

    gerarTudo() {
        const dias = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        let plano = {};
        
        // Embaralha as listas para garantir 0 repeti√ß√£o
        let dCafe = this.shuffle([...this.banco.cafe]);
        let dLM = this.shuffle([...this.banco.lanchesM]);
        let dLT = this.shuffle([...this.banco.lanchesT]);
        let dJan = this.shuffle([...this.banco.jantar]);
        let dProt = this.shuffle([...this.banco.almoco.proteinas]);
        let dAcom = this.shuffle([...this.banco.almoco.acompa]);

        dias.forEach((d, index) => {
            const itemC = dCafe[index];
            const itemJ = dJan[index];
            const isFDS = (d === "S√ÅBADO" || d === "DOMINGO");

            // Bebida √∫nica (L√≥gica refor√ßada)
            const bebC = itemC.c === "liq" ? "" : "‚Ä¢ " + this.banco.bebidasCafe[Math.floor(Math.random()*4)];
            
            // Regra do F√≠gado
            let pAlmoco = dProt[index % dProt.length];
            if (isFDS && pAlmoco.includes("F√≠gado")) pAlmoco = "Frango Grelhado";

            plano[d] = {
                cafe: { txt: `${itemC.t}<br>${bebC}`, ing: itemC.i, liq: itemC.c === "liq" },
                lancheM: dLM[index],
                almoco: {
                    txt: `‚Ä¢ ${this.banco.almoco.arroz[index % 2]}<br>‚Ä¢ ${this.banco.almoco.feijoes[index % 3]}<br>‚Ä¢ ${pAlmoco}<br>‚Ä¢ ${dAcom[index % dAcom.length]}<br>‚Ä¢ ü•§ Suco`,
                    ing: `Arroz, Feij√£o, ${pAlmoco}, Acompanhamento, Frutas para suco`,
                    sob: isFDS ? "üçÆ Sobremesa" : ""
                },
                lancheT: dLT[index],
                jantar: { txt: `${itemJ.t}${itemJ.c === "liq" ? "" : "<br>‚Ä¢ ü•§ Suco"}`, ing: itemJ.i }
            };
        });

        localStorage.setItem("plano_v14", JSON.stringify(plano));
        return plano;
    },

    mudarAba(aba, btn) {
        const container = document.getElementById("conteudo-principal");
        if (btn) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
        }

        let plano = JSON.parse(localStorage.getItem("plano_v14")) || this.gerarTudo();
        const diasNomes = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        const hojeIdx = new Date().getDay() === 0 ? 6 : new Date().getDay() - 1;
        const diaNome = diasNomes[hojeIdx];
        const d = plano[diaNome];

        if (aba === 'dia') {
            container.innerHTML = `
                <div class="bloco"><h3>‚òï Caf√©</h3><p>${d.cafe.txt}</p>${d.cafe.liq ? '<span class="opcional">Dica: Se preferir, troque por P√£o com Caf√©</span>' : ''}</div>
                <div class="bloco"><h3>üçé Lanche M</h3><p>${d.lancheM}</p></div>
                <div class="bloco"><h3>üçõ Almo√ßo</h3><p>${d.almoco.txt}</p><b>${d.almoco.sob}</b></div>
                <div class="bloco"><h3>üç™ Lanche T</h3><p>${d.lancheT}</p></div>
                <div class="bloco"><h3>üåô Jantar</h3><p>${d.jantar.txt}</p></div>
            `;
        } 
        else if (aba === 'semana') {
            let html = `<div class="table-wrapper"><table><tr><th>Refei√ß√£o</th>`;
            diasNomes.forEach((dn, i) => html += `<th class="${i===hojeIdx?'hoje-col':''}">${dn}</th>`);
            html += `</tr>`;
            const refs = [{n:"Caf√©",k:"cafe"},{n:"L. Manh√£",k:"lancheM"},{n:"Almo√ßo",k:"almoco"},{n:"L. Tarde",k:"lancheT"},{n:"Jantar",k:"jantar"}];
            refs.forEach(r => {
                html += `<tr><td style="font-weight:bold; background:#f9f9f9">${r.n}</td>`;
                diasNomes.forEach((dn, i) => {
                    let dado = plano[dn][r.k];
                    html += `<td class="${i===hojeIdx?'hoje-col':''}">${dado.txt || dado}</td>`;
                });
                html += `</tr>`;
            });
            container.innerHTML = html + `</table></div>`;
        }
        else if (aba === 'receitas') {
            container.innerHTML = `
                <h2>Ingredientes para Hoje (${diaNome})</h2>
                <div class="bloco"><h3>üõí O que usar (Clique para editar)</h3>
                    <div class="editavel" contenteditable="true">
                        <b>CAF√â:</b> ${d.cafe.ing}<br><br>
                        <b>ALMO√áO:</b> ${d.almoco.ing}<br><br>
                        <b>JANTAR:</b> ${d.jantar.ing}<br><br>
                        <b>EXTRAS:</b> ${d.lancheM}, ${d.lancheT}
                    </div>
                    <small class="aviso-edit">Voc√™ pode apagar ou escrever novos itens acima.</small>
                </div>
            `;
        }
        else if (aba === 'compras') {
            let todos = [];
            diasNomes.forEach(dn => {
                todos.push(plano[dn].cafe.ing, plano[dn].lancheM, plano[dn].lancheT, plano[dn].jantar.ing);
            });
            let unique = [...new Set(todos.join(', ').split(', '))].sort();
            container.innerHTML = `<h2>Compras da Semana</h2><div class="bloco">${unique.map(i => `<span class="compras-item">${i}</span>`).join('')}</div>`;
        }
    }
};

window.onload = () => app.mudarAba('dia');
</script>
</body>
</html>        <button onclick="app.reset()" class="btn-reset">For√ßar Carregamento (Reset)</button>
    </div>
</div>

<script>
const app = {
    // Dados base
    dados: {
        cafe: ["P√£o com Ovo", "Cuscuz com Ovo", "P√£o com Queijo", "Aipim Cozido", "Batata Doce", "P√£o com Manteiga"],
        liq: ["Mingau de Tapioca", "Mingau de Milho"],
        bebidas: ["Caf√©", "Leite", "Ch√°", "Suco"],
        almoco: {
            arroz: ["Arroz Branco", "Arroz com Cenoura"],
            feijao: ["Carioca", "Preto", "Fradinho"],
            prot: ["Frango Assado", "Carne Mo√≠da", "Bife", "Peixe", "Alm√¥ndegas"],
            acompa: ["Pur√©", "Salada", "Couve", "Farofa", "Creme de Milho"]
        },
        lanches: ["Banana", "Ma√ß√£", "Uva", "Melancia", "Iogurte", "Bolo", "P√£o de Queijo", "Pipoca", "Sandu√≠che", "Vitamina"]
    },

    init() {
        try {
            if (!localStorage.getItem("cardapio_v16")) this.gerar();
            this.aba('dia');
        } catch (e) {
            this.reset();
        }
    },

    reset() {
        localStorage.clear();
        this.gerar();
        this.aba('dia');
    },

    gerar() {
        const dias = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        let plano = {};
        
        // Feij√£o repetido por 4 dias
        const f1 = this.dados.almoco.feijao[Math.floor(Math.random()*3)];
        const f2 = this.dados.almoco.feijao.filter(f => f !== f1)[0];

        dias.forEach((d, i) => {
            const isLiq = Math.random() > 0.8;
            const pratoCafe = isLiq ? this.dados.liq[i % 2] : this.dados.cafe[i % 6];
            const beb = isLiq ? "" : "‚Ä¢ " + this.dados.bebidas[i % 4];
            
            plano[d] = {
                cafe: pratoCafe + "<br>" + beb,
                lancheM: this.dados.lanches[i],
                almoco: "‚Ä¢ " + this.dados.almoco.arroz[i % 2] + "<br>‚Ä¢ Feij√£o " + (i < 4 ? f1 : f2) + "<br>‚Ä¢ " + this.dados.almoco.prot[i % 5] + "<br>‚Ä¢ " + this.dados.almoco.acompa[i % 5],
                lancheT: this.dados.lanches[(i + 5) % 10],
                jantar: "Sopa ou Arroz com Ovo",
                ing: "Ingredientes base do dia: " + pratoCafe + ", " + (i < 4 ? f1 : f2) + ", etc."
            };
        });
        localStorage.setItem("cardapio_v16", JSON.stringify(plano));
    },

    aba(nome, btn) {
        const div = document.getElementById("conteudo");
        const plano = JSON.parse(localStorage.getItem("cardapio_v16"));
        if (!plano) return;

        if (btn) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
        }

        const hojeIdx = new Date().getDay() === 0 ? 6 : new Date().getDay() - 1;
        const dias = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        const d = plano[dias[hojeIdx]];

        if (nome === 'dia') {
            div.innerHTML = `
                <div class="bloco"><h3>‚òï Caf√©</h3><p>${d.cafe}</p></div>
                <div class="bloco"><h3>üçé Lanche M</h3><p>${d.lancheM}</p></div>
                <div class="bloco"><h3>üçõ Almo√ßo</h3><p>${d.almoco}</p></div>
                <div class="bloco"><h3>üç™ Lanche T</h3><p>${d.lancheT}</p></div>
                <div class="bloco"><h3>üåô Jantar</h3><p>${d.jantar}</p></div>
            `;
        } else if (nome === 'semana') {
            let h = '<div class="table-wrapper"><table><tr><th>Refei√ß√£o</th>';
            dias.forEach(dn => h += `<th>${dn}</th>`);
            h += '</tr>';
            const linhas = [["Caf√©", "cafe"], ["L. Manh√£", "lancheM"], ["Almo√ßo", "almoco"], ["L. Tarde", "lancheT"], ["Jantar", "jantar"]];
            linhas.forEach(l => {
                h += `<tr><td><b>${l[0]}</b></td>`;
                dias.forEach(dn => h += `<td>${plano[dn][l[1]]}</td>`);
                h += '</tr>';
            });
            div.innerHTML = h + '</table></div>';
        } else if (nome === 'receitas') {
            div.innerHTML = `<h3>Ingredientes (Edit√°vel)</h3><textarea oninput="localStorage.setItem('notas', this.value)">${localStorage.getItem('notas') || d.ing}</textarea>`;
        } else {
            div.innerHTML = `<h3>Lista de Compras</h3><div class="bloco">Consulte a tabela para ver todos os itens da semana.</div>`;
        }
    }
};

// Tenta iniciar 
window.addEventListener('load', () => app.init());
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card√°pio Inteligente v16</title>
    <style>
        :root { --primary: #4CAF50; --bg: #f4f4f9; --text: #333; }
        body { font-family: sans-serif; background: var(--bg); margin: 0; padding: 10px; color: var(--text); }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .nav-tabs { display: flex; gap: 5px; margin-bottom: 15px; background: #ddd; padding: 5px; border-radius: 8px; overflow-x: auto; }
        .tab { flex: 1; padding: 12px; text-align: center; border-radius: 6px; cursor: pointer; font-weight: bold; border: none; background: #eee; font-size: 14px; }
        .tab.active { background: var(--primary); color: white; }
        .bloco { border-left: 4px solid var(--primary); background: #f1f1f1; padding: 12px; margin-bottom: 10px; border-radius: 4px; }
        h3 { margin: 0 0 5px 0; font-size: 12px; color: #666; text-transform: uppercase; }
        p { margin: 0; font-size: 16px; }
        .table-wrapper { width: 100%; overflow-x: auto; margin-top: 10px; }
        table { width: 100%; border-collapse: collapse; min-width: 800px; font-size: 12px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: var(--primary); color: white; }
        textarea { width: 100%; min-height: 200px; padding: 10px; box-sizing: border-box; font-family: inherit; }
        .btn-reset { background: #ff4444; color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <div class="nav-tabs">
        <button class="tab active" onclick="app.aba('dia', this)">Hoje</button>
        <button class="tab" onclick="app.aba('semana', this)">Tabela</button>
        <button class="tab" onclick="app.aba('receitas', this)">Ingredientes</button>
        <button class="tab" onclick="app.aba('compras', this)">Compras</button>
    </div>
    
    <div id="conteudo">
        <p>A carregar... se demorar, clique no bot√£o abaixo:</p>
        <button onclick="app.reset()" class="btn-reset">For√ßar Carregamento (Reset)</button>
    </div>
</div>

<script>
const app = {
    // Dados base
    dados: {
        cafe: ["P√£o com Ovo", "Cuscuz com Ovo", "P√£o com Queijo", "Aipim Cozido", "Batata Doce", "P√£o com Manteiga"],
        liq: ["Mingau de Tapioca", "Mingau de Milho"],
        bebidas: ["Caf√©", "Leite", "Ch√°", "Suco"],
        almoco: {
            arroz: ["Arroz Branco", "Arroz com Cenoura"],
            feijao: ["Carioca", "Preto", "Fradinho"],
            prot: ["Frango Assado", "Carne Mo√≠da", "Bife", "Peixe", "Alm√¥ndegas"],
            acompa: ["Pur√©", "Salada", "Couve", "Farofa", "Creme de Milho"]
        },
        lanches: ["Banana", "Ma√ß√£", "Uva", "Melancia", "Iogurte", "Bolo", "P√£o de Queijo", "Pipoca", "Sandu√≠che", "Vitamina"]
    },

    init() {
        try {
            if (!localStorage.getItem("cardapio_v16")) this.gerar();
            this.aba('dia');
        } catch (e) {
            this.reset();
        }
    },

    reset() {
        localStorage.clear();
        this.gerar();
        this.aba('dia');
    },

    gerar() {
        const dias = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        let plano = {};
        
        // Feij√£o repetido por 4 dias
        const f1 = this.dados.almoco.feijao[Math.floor(Math.random()*3)];
        const f2 = this.dados.almoco.feijao.filter(f => f !== f1)[0];

        dias.forEach((d, i) => {
            const isLiq = Math.random() > 0.8;
            const pratoCafe = isLiq ? this.dados.liq[i % 2] : this.dados.cafe[i % 6];
            const beb = isLiq ? "" : "‚Ä¢ " + this.dados.bebidas[i % 4];
            
            plano[d] = {
                cafe: pratoCafe + "<br>" + beb,
                lancheM: this.dados.lanches[i],
                almoco: "‚Ä¢ " + this.dados.almoco.arroz[i % 2] + "<br>‚Ä¢ Feij√£o " + (i < 4 ? f1 : f2) + "<br>‚Ä¢ " + this.dados.almoco.prot[i % 5] + "<br>‚Ä¢ " + this.dados.almoco.acompa[i % 5],
                lancheT: this.dados.lanches[(i + 5) % 10],
                jantar: "Sopa ou Arroz com Ovo",
                ing: "Ingredientes base do dia: " + pratoCafe + ", " + (i < 4 ? f1 : f2) + ", etc."
            };
        });
        localStorage.setItem("cardapio_v16", JSON.stringify(plano));
    },

    aba(nome, btn) {
        const div = document.getElementById("conteudo");
        const plano = JSON.parse(localStorage.getItem("cardapio_v16"));
        if (!plano) return;

        if (btn) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
        }

        const hojeIdx = new Date().getDay() === 0 ? 6 : new Date().getDay() - 1;
        const dias = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        const d = plano[dias[hojeIdx]];

        if (nome === 'dia') {
            div.innerHTML = `
                <div class="bloco"><h3>‚òï Caf√©</h3><p>${d.cafe}</p></div>
                <div class="bloco"><h3>üçé Lanche M</h3><p>${d.lancheM}</p></div>
                <div class="bloco"><h3>üçõ Almo√ßo</h3><p>${d.almoco}</p></div>
                <div class="bloco"><h3>üç™ Lanche T</h3><p>${d.lancheT}</p></div>
                <div class="bloco"><h3>üåô Jantar</h3><p>${d.jantar}</p></div>
            `;
        } else if (nome === 'semana') {
            let h = '<div class="table-wrapper"><table><tr><th>Refei√ß√£o</th>';
            dias.forEach(dn => h += `<th>${dn}</th>`);
            h += '</tr>';
            const linhas = [["Caf√©", "cafe"], ["L. Manh√£", "lancheM"], ["Almo√ßo", "almoco"], ["L. Tarde", "lancheT"], ["Jantar", "jantar"]];
            linhas.forEach(l => {
                h += `<tr><td><b>${l[0]}</b></td>`;
                dias.forEach(dn => h += `<td>${plano[dn][l[1]]}</td>`);
                h += '</tr>';
            });
            div.innerHTML = h + '</table></div>';
        } else if (nome === 'receitas') {
            div.innerHTML = `<h3>Ingredientes (Edit√°vel)</h3><textarea oninput="localStorage.setItem('notas', this.value)">${localStorage.getItem('notas') || d.ing}</textarea>`;
        } else {
            div.innerHTML = `<h3>Lista de Compras</h3><div class="bloco">Consulte a tabela para ver todos os itens da semana.</div>`;
        }
    }
};

// Tenta iniciar 
window.addEventListener('load', () => app.init());
</script>
</body>
</html>

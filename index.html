<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card√°pio Inteligente v20</title>
    <style>
        :root { --primary: #4CAF50; --bg: #f4f4f9; --text: #333; }
        body { font-family: sans-serif; background: var(--bg); margin: 0; padding: 10px; color: var(--text); }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .nav-tabs { display: flex; gap: 4px; margin-bottom: 15px; background: #ddd; padding: 4px; border-radius: 8px; overflow-x: auto; }
        .tab { flex: 1; padding: 10px 4px; text-align: center; border-radius: 6px; cursor: pointer; font-weight: bold; border: none; background: #eee; font-size: 11px; white-space: nowrap; }
        .tab.active { background: var(--primary); color: white; }
        .bloco { border-left: 4px solid var(--primary); background: #f1f1f1; padding: 12px; margin-bottom: 10px; border-radius: 4px; }
        h3 { margin: 0 0 5px 0; font-size: 11px; color: #666; text-transform: uppercase; }
        .table-wrap { width: 100%; overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; min-width: 800px; font-size: 11px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; vertical-align: top; }
        th { background: #eee; }
        .hoje { background: #e8f5e9 !important; border: 2px solid var(--primary) !important; }
        .item-compra { display: block; padding: 6px; border-bottom: 1px solid #eee; }
        .checked { text-decoration: line-through; color: #999; }
    </style>
</head>
<body>

<div class="container">
    <div class="nav-tabs">
        <button class="tab active" onclick="app.aba('dia', this)">Hoje</button>
        <button class="tab" onclick="app.aba('semana', this)">Tabela</button>
        <button class="tab" onclick="app.aba('receitas', this)">Ingredientes</button>
        <button class="tab" onclick="app.aba('compras', this)">Compras</button>
    </div>
    <div id="painel">Carregando...</div>
</div>

<script>
const app = {
    base: {
        cafe: ["P√£o com ovo", "Cuscuz", "Mingau de milho", "Mingau de tapioca", "Aipim cozido"],
        bebidas: ["Caf√© puro", "Suco de Laranja", "Ch√° de Erva-doce", "Caf√© com Manteiga"],
        frangos: ["Frango Assado", "Frango Grelhado", "Frango Ensopado", "Strogonoff de Frango", "Frango com Quiabo"],
        carnes: ["Carne mo√≠da com batata", "Bife acebolado", "Alm√¥ndegas ao molho", "Iscas de carne"],
        acompa: ["Pur√© de batata", "Salada de alface/tomate", "Couve refogada", "Farofa de ovos"],
        jantares: ["Sopa de Lentilha", "Omelete Recheada", "Canja de Galinha", "Tapioca com Frango", "Macarr√£o Alho e √ìleo", "Caldo Verde", "Sandu√≠che Natural"],
        lanches: ["Banana", "Ma√ß√£", "Uva", "Melancia", "Iogurte", "Bolo Caseiro"]
    },

    init() {
        if (!localStorage.getItem("plano_v20")) this.gerar();
        this.aba('dia');
    },

    gerar() {
        const dias = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        let plano = {};
        dias.forEach((d, i) => {
            const protAlmoco = (i % 2 === 0) ? this.base.frangos[i % 5] : this.base.carnes[i % 4];
            plano[d] = {
                cafe: this.base.cafe[i % 5],
                bebida: this.base.bebidas[i % 4],
                lanche: this.base.lanches[i % 6],
                almoco: `‚Ä¢ Arroz e Feij√£o<br>‚Ä¢ ${protAlmoco}<br>‚Ä¢ ${this.base.acompa[i % 4]}`,
                jantar: this.base.jantares[i % 7],
                cafe_nome: this.base.cafe[i % 5],
                almoco_nome: protAlmoco,
                jantar_nome: this.base.jantares[i % 7]
            };
        });
        localStorage.setItem("plano_v20", JSON.stringify(plano));
    },

    aba(nome, btn) {
        const painel = document.getElementById("painel");
        const plano = JSON.parse(localStorage.getItem("plano_v20"));
        if (btn) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
        }

        const hoje = new Date().getDay();
        const idx = hoje === 0 ? 6 : hoje - 1;
        const dias = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        const d = plano[dias[idx]];

        if (nome === 'dia') {
            painel.innerHTML = `
                <div class="bloco"><h3>‚òï Caf√©</h3><p>${d.cafe}<br>‚Ä¢ ${d.bebida}</p></div>
                <div class="bloco"><h3>üçé Lanche</h3><p>${d.lanche}</p></div>
                <div class="bloco"><h3>üçõ Almo√ßo</h3><p>${d.almoco}</p></div>
                <div class="bloco"><h3>üåô Jantar Espec√≠fico</h3><p>${d.jantar}</p></div>
            `;
        } else if (nome === 'semana') {
            let html = '<div class="table-wrap"><table><tr><th>Dia</th><th>Caf√©</th><th>Almo√ßo</th><th>Jantar</th></tr>';
            dias.forEach((dn, i) => {
                const dia = plano[dn];
                html += `<tr class="${i === idx ? 'hoje' : ''}"><td><b>${dn}</b></td><td>${dia.cafe}</td><td>${dia.almoco}</td><td>${dia.jantar}</td></tr>`;
            });
            painel.innerHTML = html + '</table></div>';
        } else if (nome === 'receitas') {
            let html = '<h2>Ingredientes Permanentes</h2>';
            [d.cafe_nome, d.almoco_nome, d.jantar_nome].forEach(r => {
                const salvo = localStorage.getItem("ing_"+r) || "";
                html += `<div class="bloco"><h3>${r}</h3><textarea style="width:100%; height:50px;" oninput="localStorage.setItem('ing_${r}', this.value)" placeholder="V√≠rgula entre itens...">${salvo}</textarea></div>`;
            });
            painel.innerHTML = html;
        } else if (nome === 'compras') {
            let itens = new Set();
            dias.forEach(dn => {
                const dia = plano[dn];
                itens.add(dia.bebida);
                itens.add(dia.lanche);
                [dia.cafe_nome, dia.almoco_nome, dia.jantar_nome].forEach(r => {
                    const ing = localStorage.getItem("ing_"+r);
                    if(ing) ing.split(',').forEach(i => itens.add(i.trim()));
                });
            });
            let html = '<h2>Checklist de Compras</h2><div class="bloco">';
            Array.from(itens).sort().forEach((it, i) => {
                if(it.length > 2) html += `<label class="item-compra"><input type="checkbox" onclick="this.parentNode.classList.toggle('checked')"> ${it}</label>`;
            });
            painel.innerHTML = html + '</div>';
        }
    }
};

window.onload = () => app.init();
</script>
</body>
</html>

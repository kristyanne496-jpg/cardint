<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card√°pio Inteligente v13</title>
    <style>
        :root { --primary: #4CAF50; --bg: #f4f4f9; --text: #333; --accent: #ff9800; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 10px; color: var(--text); line-height: 1.5; }
        .container { max-width: 1100px; margin: 0 auto; background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        
        /* Navega√ß√£o */
        .nav-tabs { display: flex; gap: 5px; margin-bottom: 20px; background: #eee; padding: 5px; border-radius: 10px; }
        .tab { flex: 1; padding: 12px 5px; text-align: center; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 13px; border: none; background: none; }
        .tab.active { background: var(--primary); color: white; }

        /* Blocos de Conte√∫do */
        .bloco { border-left: 5px solid var(--primary); background: #f9f9f9; padding: 15px; margin-bottom: 15px; border-radius: 5px; }
        .bloco h3 { margin: 0 0 8px 0; font-size: 0.9em; color: #666; text-transform: uppercase; letter-spacing: 1px; }
        .bloco p { margin: 0; font-size: 1em; color: var(--text); }

        /* Tabelas */
        .table-wrapper { width: 100%; overflow-x: auto; border: 1px solid #ddd; border-radius: 10px; }
        table { width: 100%; border-collapse: collapse; min-width: 900px; }
        th { background: var(--primary); color: white; padding: 12px; font-size: 0.8em; text-align: left; }
        td { padding: 12px; border-bottom: 1px solid #eee; font-size: 0.85em; vertical-align: top; }
        .ref-header { background: #f1f1f1; font-weight: bold; width: 100px; position: sticky; left: 0; }
        .hoje-col { background: #e8f5e9 !important; font-weight: bold; }

        /* Ingredientes e Compras */
        .lista-info { list-style: none; padding: 0; margin: 0; }
        .lista-info li { background: #fff; border: 1px solid #eee; padding: 10px; margin-bottom: 8px; border-radius: 6px; display: flex; align-items: center; }
        .lista-info li::before { content: "‚Ä¢"; color: var(--primary); font-weight: bold; margin-right: 10px; font-size: 1.5em; }
        .compras-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; }
        
        .opcional { color: #d32f2f; font-weight: bold; font-size: 0.8em; display: block; margin-top: 5px; }
    </style>
</head>
<body>

<div class="container">
    <div class="nav-tabs">
        <button class="tab active" onclick="app.mudarAba('dia', this)">Hoje</button>
        <button class="tab" onclick="app.mudarAba('semana', this)">Tabela</button>
        <button class="tab" onclick="app.mudarAba('receitas', this)">Receitas</button>
        <button class="tab" onclick="app.mudarAba('compras', this)">Compras</button>
    </div>
    <div id="conteudo-principal">Iniciando sistema...</div>
</div>

<script>
const app = {
    banco: {
        cafe: [
            { t: "P√£o com ovo", c: "sol", i: ["P√£o franc√™s", "Ovos", "Manteiga"] },
            { t: "P√£o com manteiga", c: "sol", i: ["P√£o franc√™s", "Manteiga"] },
            { t: "Mingau de tapioca", c: "liq", i: ["Tapioca granulada", "Leite", "Coco", "A√ß√∫car"] },
            { t: "Mingau de milho", c: "liq", i: ["Milho", "Leite", "Canela"] },
            { t: "Cuscuz com ovo", c: "sol", i: ["Floc√£o de milho", "Ovos", "Manteiga"] },
            { t: "Cuscuz com manteiga", c: "sol", i: ["Floc√£o de milho", "Manteiga"] },
            { t: "P√£o com queijo e presunto", c: "sol", i: ["P√£o", "Queijo", "Presunto"] },
            { t: "Aipim cozido", c: "sol", i: ["Aipim/Mandioca", "Sal"] },
            { t: "Batata doce cozida", c: "sol", i: ["Batata doce"] }
        ],
        almoco: {
            arroz: ["Arroz Branco", "Arroz com Cenoura"],
            feijoes: ["Feij√£o carioca", "Feij√£o preto", "Feij√£o fradinho"],
            proteinas: ["Frango assado", "Carne mo√≠da", "Bife no molho", "Peixe frito", "F√≠gado acebolado"],
            acompa: ["Pur√© de batata", "Salada de maionese", "Couve refogada", "Farofa", "Creme de milho"],
            sucos: ["Maracuj√°", "Laranja", "Abacaxi", "Lim√£o"]
        },
        jantar: [
            { t: "Arroz com ovo", c: "sol", i: ["Arroz", "Ovos"] },
            { t: "Sopa de legumes", c: "liq", i: ["Legumes variados", "Macarr√£o"] },
            { t: "Cuscuz com ovo", c: "sol", i: ["Milho", "Ovos"] },
            { t: "Tapioca recheada", c: "sol", i: ["Goma de tapioca", "Queijo"] }
        ],
        bebidasCafe: ["Caf√© puro", "Leite com achocolatado", "Ch√° de Hortel√£", "Suco de Laranja"],
        lanchesM: ["Banana", "Ma√ß√£", "Uva", "Melancia", "Pera"],
        lanchesT: ["Iogurte", "Bolo Caseiro", "P√£o de Queijo", "Pipoca"]
    },

    gerarTudo() {
        const dias = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        let plano = {};
        
        // C√≥pias para n√£o repetir na semana
        let dCafe = [...this.banco.cafe].sort(() => Math.random() - 0.5);
        let dLM = [...this.banco.lanchesM].sort(() => Math.random() - 0.5);
        let dLT = [...this.banco.lanchesT].sort(() => Math.random() - 0.5);
        let dJan = [...this.banco.jantar].sort(() => Math.random() - 0.5);

        dias.forEach((d, index) => {
            const isFDS = (d === "S√ÅBADO" || d === "DOMINGO");
            const itemC = dCafe[index] || this.banco.cafe[0];
            const itemJ = dJan[index % dJan.length];
            
            // Bebida √∫nica (apenas se n√£o for l√≠quido)
            const bebC = itemC.c === "liq" ? "" : "‚Ä¢ " + this.banco.bebidasCafe[Math.floor(Math.random() * 4)];
            
            // Almo√ßo
            let prot = this.banco.almoco.proteinas[Math.floor(Math.random() * 5)];
            if (isFDS && prot.includes("F√≠gado")) prot = "Frango Assado";

            plano[d] = {
                cafe: { txt: `${itemC.t}<br>${bebC}`, ing: itemC.i, obs: itemC.c === "liq" ? "<span class='opcional'>Op√ß√£o 2: P√£o com Caf√©</span>" : "" },
                lancheM: dLM[index] || "Ma√ß√£",
                almoco: {
                    txt: `‚Ä¢ ${this.banco.almoco.arroz[index % 2]}<br>‚Ä¢ ${this.banco.almoco.feijoes[index % 3]}<br>‚Ä¢ ${prot}<br>‚Ä¢ ${this.banco.almoco.acompa[index % 5]}<br>‚Ä¢ ü•§ Suco de ${this.banco.almoco.sucos[index % 4]}`,
                    ing: ["Ingredientes base do almo√ßo"],
                    sob: isFDS ? "üçÆ Sobremesa Especial" : ""
                },
                lancheT: dLT[index] || "Iogurte",
                jantar: { txt: `${itemJ.t}<br>${itemJ.c === "liq" ? "" : "‚Ä¢ ü•§ Suco"}`, ing: itemJ.i }
            };
        });

        localStorage.setItem("plano_v13", JSON.stringify(plano));
        return plano;
    },

    mudarAba(aba, btn) {
        const container = document.getElementById("conteudo-principal");
        if (btn) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
        }

        let plano = JSON.parse(localStorage.getItem("plano_v13")) || this.gerarTudo();
        const diasNomes = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        const hojeIdx = new Date().getDay() === 0 ? 6 : new Date().getDay() - 1;
        const diaNome = diasNomes[hojeIdx];
        const d = plano[diaNome];

        if (aba === 'dia') {
            container.innerHTML = `
                <div class="bloco"><h3>‚òï Caf√© da Manh√£</h3><p>${d.cafe.txt}${d.cafe.obs}</p></div>
                <div class="bloco"><h3>üçé Lanche Manh√£</h3><p>${d.lancheM}</p></div>
                <div class="bloco"><h3>üçõ Almo√ßo</h3><p>${d.almoco.txt}</p><b>${d.almoco.sob}</b></div>
                <div class="bloco"><h3>üç™ Lanche Tarde</h3><p>${d.lancheT}</p></div>
                <div class="bloco"><h3>üåô Jantar</h3><p>${d.jantar.txt}</p></div>
            `;
        } 
        else if (aba === 'semana') {
            let html = `<div class="table-wrapper"><table><tr><th class="ref-header">Refei√ß√£o</th>`;
            diasNomes.forEach((dn, i) => html += `<th class="${i===hojeIdx?'hoje-col':''}">${dn}</th>`);
            html += `</tr>`;
            
            const refs = [
                {n: "Caf√©", k: "cafe"}, {n: "L. Manh√£", k: "lancheM"}, 
                {n: "Almo√ßo", k: "almoco"}, {n: "L. Tarde", k: "lancheT"}, {n: "Jantar", k: "jantar"}
            ];

            refs.forEach(r => {
                html += `<tr><td class="ref-header">${r.n}</td>`;
                diasNomes.forEach((dn, i) => {
                    let dado = plano[dn][r.k];
                    html += `<td class="${i===hojeIdx?'hoje-col':''}">${dado.txt || dado}</td>`;
                });
                html += `</tr>`;
            });
            container.innerHTML = html + `</table></div>`;
        }
        else if (aba === 'receitas') {
            container.innerHTML = `
                <h2>Ingredientes para Hoje (${diaNome})</h2>
                <div class="bloco"><h3>No Caf√©</h3><ul class="lista-info">${d.cafe.ing.map(i => `<li>${i}</li>`).join('')}</ul></div>
                <div class="bloco"><h3>No Jantar</h3><ul class="lista-info">${d.jantar.ing.map(i => `<li>${i}</li>`).join('')}</ul></div>
            `;
        }
        else if (aba === 'compras') {
            let todos = [];
            diasNomes.forEach(dn => {
                todos.push(...plano[dn].cafe.ing, ...plano[dn].jantar.ing, plano[dn].lancheM, plano[dn].lancheT);
            });
            let unique = [...new Set(todos)].sort();
            container.innerHTML = `<h2>Lista de Compras Semanal</h2><div class="compras-grid">${unique.map(i => `<div class="bloco">${i}</div>`).join('')}</div>`;
        }
    }
};

window.onload = () => app.mudarAba('dia');
</script>
</body>
</html>

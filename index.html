<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card√°pio Inteligente v22 - Vis√£o Total</title>
    <style>
        :root { --primary: #2e7d32; --bg: #f0f2f5; --text: #1a1a1a; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); margin: 0; padding: 10px; color: var(--text); }
        .container { max-width: 1100px; margin: 0 auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        .nav-tabs { display: flex; gap: 5px; margin-bottom: 20px; background: #e0e0e0; padding: 5px; border-radius: 10px; overflow-x: auto; }
        .tab { flex: 1; padding: 12px 8px; text-align: center; border-radius: 8px; cursor: pointer; font-weight: bold; border: none; background: transparent; font-size: 12px; white-space: nowrap; transition: 0.3s; }
        .tab.active { background: var(--primary); color: white; }
        .bloco { border-left: 6px solid var(--primary); background: #f8f9fa; padding: 18px; margin-bottom: 15px; border-radius: 8px; box-shadow: 2px 2px 5px rgba(0,0,0,0.02); }
        h3 { margin: 0 0 8px 0; font-size: 12px; color: #555; text-transform: uppercase; letter-spacing: 1px; }
        p { margin: 0; font-size: 16px; line-height: 1.5; }
        .table-wrap { width: 100%; overflow-x: auto; border-radius: 8px; border: 1px solid #ddd; }
        table { width: 100%; border-collapse: collapse; min-width: 1000px; background: white; }
        th, td { border: 1px solid #eee; padding: 12px; text-align: left; vertical-align: top; font-size: 12px; }
        th { background: #f4f4f4; font-weight: bold; color: #333; }
        .hoje-row { background: #e8f5e9 !important; border: 2px solid var(--primary) !important; }
        .edit-box { width: 100%; min-height: 70px; padding: 10px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-family: inherit; margin-top: 5px; }
        .item-compra { display: flex; align-items: center; gap: 12px; padding: 10px; border-bottom: 1px solid #f0f0f0; cursor: pointer; font-size: 14px; }
        .item-compra input { width: 20px; height: 20px; accent-color: var(--primary); }
        .checked { text-decoration: line-through; color: #999; font-style: italic; }
        .alerta-mingau { background: #fff3e0; border: 2px dashed #ff9800; padding: 12px; border-radius: 8px; margin-top: 10px; color: #e65100; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="nav-tabs">
        <button class="tab active" onclick="app.mudarAba('dia', this)">Card√°pio de Hoje</button>
        <button class="tab" onclick="app.mudarAba('semana', this)">Tabela Semanal</button>
        <button class="tab" onclick="app.mudarAba('receitas', this)">Ingredientes por Prato</button>
        <button class="tab" onclick="app.mudarAba('compras', this)">Lista de Compras (Estoque)</button>
    </div>
    <div id="app-view">Sincronizando todas as informa√ß√µes...</div>
</div>

<script>
const app = {
    base: {
        cafe: [
            { t: "P√£o com ovo", m: false, s: "" },
            { t: "Cuscuz com ovo", m: false, s: "" },
            { t: "Mingau de tapioca", m: true, s: "P√£o de forma com Manteiga e Caf√©" },
            { t: "Mingau de milho", m: true, s: "P√£o Franc√™s com Queijo e Caf√©" },
            { t: "Aipim cozido com manteiga", m: false, s: "" }
        ],
        bebidas: ["Caf√© puro", "Suco de Laranja", "Ch√° de Erva-doce", "Suco de Abacaxi", "Suco de Acerola"],
        frangos: ["Frango Assado", "Frango Grelhado", "Frango Ensopado com Batata", "Strogonoff de Frango", "Frango com Quiabo"],
        carnes: ["Carne mo√≠da com legumes", "Bife acebolado", "Alm√¥ndegas ao molho", "Iscas de carne com piment√£o"],
        acompa: ["Pur√© de batata", "Salada Completa", "Couve refogada", "Farofa de ovos", "Creme de milho"],
        lanchesM: ["Banana", "Ma√ß√£", "Uva", "Pera", "Melancia"],
        lanchesT: ["Iogurte", "Bolo Caseiro", "P√£o de Queijo", "Pipoca", "Sandu√≠che Natural"],
        jantares: ["Sopa de Lentilha", "Omelete Recheada", "Canja de Galinha", "Tapioca com Frango", "Caldo Verde", "Sopa de Macarr√£o", "Cuscuz Nordestino"]
    },

    init() {
        if (localStorage.getItem("v_final") !== "22.0") {
            localStorage.clear();
            localStorage.setItem("v_final", "22.0");
            this.gerar();
        }
        this.mudarAba('dia');
    },

    gerar() {
        const dias = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        let plano = {};
        dias.forEach((d, i) => {
            const cafeObj = this.base.cafe[i % 5];
            const pratoAlmoco = (i % 2 === 0) ? this.base.frangos[i % 5] : this.base.carnes[i % 4];
            const acompAlmoco = this.base.acompa[i % 5];
            
            plano[d] = {
                cafe: cafeObj.t,
                isMingau: cafeObj.m,
                opcao2: cafeObj.s,
                bebida: cafeObj.m ? "N√£o (Dia de Mingau)" : this.base.bebidas[i % 5],
                lancheM: this.base.lanchesM[i % 5],
                almoco_p: pratoAlmoco,
                almoco_a: acompAlmoco,
                lancheT: this.base.lanchesT[i % 5],
                jantar: this.base.jantares[i % 7]
            };
        });
        localStorage.setItem("plano_v22", JSON.stringify(plano));
    },

    mudarAba(aba, btn) {
        const painel = document.getElementById("app-view");
        const plano = JSON.parse(localStorage.getItem("plano_v22"));
        if (btn) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
        }

        const hojeNum = new Date().getDay();
        const hojeIdx = hojeNum === 0 ? 6 : hojeNum - 1;
        const diasNomes = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        const d = plano[diasNomes[hojeIdx]];

        if (aba === 'dia') {
            painel.innerHTML = `
                <div class="bloco"><h3>‚òï Caf√© da Manh√£</h3><p><b>${d.cafe}</b>${d.isMingau ? '' : '<br>‚Ä¢ ' + d.bebida}</p>
                ${d.isMingau ? `<div class="alerta-mingau">‚ö†Ô∏è Segunda Op√ß√£o (S√≥lida):<br>${d.opcao2}</div>` : ''}</div>
                <div class="bloco"><h3>üçé Lanche da Manh√£</h3><p>${d.lancheM}</p></div>
                <div class="bloco"><h3>üçõ Almo√ßo Completo</h3><p>‚Ä¢ Arroz e Feij√£o<br>‚Ä¢ <b>${d.almoco_p}</b><br>‚Ä¢ ${d.almoco_a}</p></div>
                <div class="bloco"><h3>üç™ Lanche da Tarde</h3><p>${d.lancheT}</p></div>
                <div class="bloco"><h3>üåô Jantar</h3><p>${d.jantar}</p></div>
            `;
        } else if (aba === 'semana') {
            let html = '<div class="table-wrap"><table><tr><th>Dia</th><th>Caf√©</th><th>L. Manh√£</th><th>Almo√ßo</th><th>L. Tarde</th><th>Jantar</th></tr>';
            diasNomes.forEach((dn, i) => {
                const dia = plano[dn];
                html += `<tr class="${i === hojeIdx ? 'hoje-row' : ''}">
                    <td><b>${dn}</b></td>
                    <td>${dia.cafe}<br><small>${dia.isMingau ? '[Mingau]' : '('+dia.bebida+')'}</small></td>
                    <td>${dia.lancheM}</td>
                    <td>${dia.almoco_p}<br>+ ${dia.almoco_a}</td>
                    <td>${dia.lancheT}</td>
                    <td>${dia.jantar}</td>
                </tr>`;
            });
            painel.innerHTML = html + '</table></div>';
        } else if (aba === 'receitas') {
            let html = '<h2>Ingredientes Permanentes</h2>';
            const lista = [d.cafe, d.almoco_p, d.almoco_a, d.jantar];
            lista.forEach(item => {
                const salvo = localStorage.getItem("ing_"+item) || "";
                html += `<div class="bloco"><h3>${item}</h3>
                <textarea class="edit-box" oninput="localStorage.setItem('ing_${item}', this.value)" placeholder="Digite os ingredientes...">${salvo}</textarea></div>`;
            });
            painel.innerHTML = html;
        } else if (aba === 'compras') {
            let itens = new Set(["Arroz", "Feij√£o", "A√ß√∫car", "Caf√© em p√≥", "Sal", "Azeite"]);
            diasNomes.forEach(dn => {
                const dia = plano[dn];
                if(!dia.isMingau) itens.add(dia.bebida);
                itens.add(dia.lancheM);
                itens.add(dia.lancheT);
                [dia.cafe, dia.almoco_p, dia.almoco_a, dia.jantar].forEach(p => {
                    const ing = localStorage.getItem("ing_"+p);
                    if(ing) ing.split(',').forEach(i => { if(i.trim()) itens.add(i.trim()); });
                });
            });
            let html = '<h2>Lista de Compras (Checklist de Estoque)</h2><div class="bloco">';
            Array.from(itens).sort().forEach(it => {
                html += `<label class="item-compra"><input type="checkbox" onclick="this.parentNode.classList.toggle('checked')"><span>${it}</span></label>`;
            });
            painel.innerHTML = html + '</div>';
        }
    }
};

window.onload = () => app.init();
</script>
</body>
</html>

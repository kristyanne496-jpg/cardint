<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card√°pio v11 - Receitas & Ingredientes</title>
    <style>
        :root { --primary: #4CAF50; --bg: #f4f4f9; --text: #333; --accent: #ff9800; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 10px; color: var(--text); }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .nav-tabs { display: flex; gap: 5px; margin-bottom: 15px; background: #eee; padding: 5px; border-radius: 10px; }
        .tab { flex: 1; padding: 10px; text-align: center; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 12px; transition: 0.3s; }
        .tab.active { background: var(--primary); color: white; }
        .table-wrapper { width: 100%; overflow-x: auto; margin-top: 15px; border: 1px solid #ddd; border-radius: 10px; }
        table { width: 100%; border-collapse: collapse; min-width: 900px; background: white; }
        th { background: var(--primary); color: white; padding: 12px; font-size: 0.8em; }
        td { padding: 10px; border: 1px solid #eee; font-size: 0.8em; vertical-align: top; }
        .bloco { border-left: 5px solid var(--primary); background: #f9f9f9; padding: 12px; margin-bottom: 12px; border-radius: 5px; }
        .bloco h3 { margin: 0 0 5px 0; font-size: 0.85em; color: #666; text-transform: uppercase; }
        .ingredientes-list { list-style: none; padding: 0; }
        .ingredientes-list li { background: #fff; margin: 5px 0; padding: 8px; border-radius: 4px; border: 1px solid #ddd; font-size: 0.9em; display: flex; align-items: center; }
        .ingredientes-list li::before { content: "üõí"; margin-right: 10px; }
        .opcional { color: #d32f2f; font-weight: bold; font-size: 0.85em; display: block; margin-top: 5px; }
        .sobremesa { color: var(--accent); font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="nav-tabs">
        <div class="tab active" onclick="app.mudarAba('dia', this)">Hoje</div>
        <div class="tab" onclick="app.mudarAba('semana', this)">Tabela</div>
        <div class="tab" onclick="app.mudarAba('receita', this)">Ingredientes</div>
    </div>
    <div id="conteudo-principal">Carregando intelig√™ncia v11...</div>
</div>

<script>
const app = {
    banco: {
        cafe: [
            { txt: "P√£o com ovo", ing: ["P√£o franc√™s", "Ovos", "Manteiga"] },
            { txt: "P√£o com queijo e presunto", ing: ["P√£o", "Queijo mussarela", "Presunto"] },
            { txt: "Mingau de tapioca", cat: "liq", ing: ["Goma de tapioca granulada", "Leite", "A√ß√∫car/Leite condensado"] },
            { txt: "Cuscuz com ovo", ing: ["Floc√£o de milho", "Ovo", "Manteiga"] },
            { txt: "Tapioca recheada", ing: ["Goma de tapioca", "Recheio (Queijo/Frango)"] },
            { txt: "Banana da terra cozida", ing: ["Banana da terra madura"] },
            { txt: "P√£o com pat√™ de atum", ing: ["P√£o", "Atum em lata", "Maionese"] }
        ],
        almoco: {
            proteinas: ["Frango assado", "Carne mo√≠da", "F√≠gado acebolado", "Bife no molho"],
            acompa: ["Pur√© de batata", "Salada de maionese", "Farofa de ovos", "Couve refogada"],
            ingBase: {
                "Arroz Branco": ["Arroz", "Alho", "Cebola"],
                "Arroz com Cenoura": ["Arroz", "Cenoura ralada", "Alho"],
                "Feij√£o carioca": ["Feij√£o", "Louro", "Alho/Cebola"],
                "Pur√© de batata": ["Batata", "Leite", "Manteiga"],
                "Salada de maionese": ["Batata", "Cenoura", "Maionese", "Ovo"],
                "F√≠gado acebolado": ["F√≠gado de boi", "Cebola em rodelas", "Piment√£o"]
            }
        },
        bebidasCafe: ["Caf√©", "Leite", "Ch√°", "Suco de Laranja"],
        lanchesM: ["Banana", "Ma√ß√£", "Uva", "Melancia"],
        lanchesT: ["Iogurte com Frutas", "Bolo Caseiro", "P√£o de Queijo", "Pipoca"]
    },

    escolherERemover(lista) {
        const idx = Math.floor(Math.random() * lista.length);
        return lista.splice(idx, 1)[0];
    },

    gerarTudo() {
        let plano = [];
        const dias = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        for (let s = 0; s < 12; s++) {
            let semana = {};
            let dispCafe = [...this.banco.cafe];
            dias.forEach(d => {
                const itemCafe = this.escolherERemover(dispCafe) || this.banco.cafe[0];
                const bebUnica = itemCafe.cat === "liq" ? "" : `‚Ä¢ ${this.banco.bebidasCafe[Math.floor(Math.random()*4)]}`;
                
                const baseArroz = Math.random() > 0.5 ? "Arroz Branco" : "Arroz com Cenoura";
                const feijao = "Feij√£o carioca";
                const prot = this.banco.almoco.proteinas[Math.floor(Math.random()*4)];
                const acompa = this.banco.almoco.acompa[Math.floor(Math.random()*4)];

                semana[d] = {
                    cafe: { txt: `${itemCafe.txt}<br>${bebUnica}`, ing: itemCafe.ing },
                    lancheM: { txt: `Fruta: ${this.banco.lanchesM[Math.floor(Math.random()*4)]}` },
                    almoco: { 
                        txt: `‚Ä¢ ${baseArroz}<br>‚Ä¢ ${feijao}<br>‚Ä¢ ${prot}<br>‚Ä¢ ${acompa}`, 
                        ing: [...this.banco.almoco.ingBase[baseArroz], ...this.banco.almoco.ingBase[feijao] || [], ...this.banco.almoco.ingBase[prot] || [prot], ...this.banco.almoco.ingBase[acompa] || [acompa]],
                        sobremesa: (d === "DOMINGO") ? "Mousse de Maracuj√°" : ""
                    },
                    lancheT: { txt: this.banco.lanchesT[Math.floor(Math.random()*4)] },
                    jantar: { txt: "Sopa de Legumes", ing: ["Legumes variados", "Macarr√£o"] }
                };
            });
            plano.push(semana);
        }
        localStorage.setItem("plano", JSON.stringify(plano));
        localStorage.setItem("v", "11.0");
        return plano;
    },

    mudarAba(aba, el) {
        if(el) { document.querySelectorAll('.tab').forEach(t => t.classList.remove('active')); el.classList.add('active'); }
        const container = document.getElementById("conteudo-principal");
        const hoje = new Date();
        let diaIdx = hoje.getDay() === 0 ? 6 : hoje.getDay() - 1;
        const nomes = ["SEGUNDA","TER√áA","QUARTA","QUINTA","SEXTA","S√ÅBADO","DOMINGO"];
        const dNome = nomes[diaIdx];
        const plano = JSON.parse(localStorage.getItem("plano"))[0];
        const diaDados = plano[dNome];

        if (aba === 'dia') {
            container.innerHTML = `
                <div class="bloco"><h3>‚òï Caf√©</h3><p>${diaDados.cafe.txt}</p></div>
                <div class="bloco"><h3>üçõ Almo√ßo</h3><p>${diaDados.almoco.txt}<br><span class="sobremesa">${diaDados.almoco.sobremesa}</span></p></div>
                <div class="bloco"><h3>üåô Jantar</h3><p>${diaDados.jantar.txt}</p></div>`;
        } else if (aba === 'receita') {
            let todosIng = [...diaDados.cafe.ing, ...diaDados.almoco.ing, ...diaDados.jantar.ing];
            let listaUnica = [...new Set(todosIng)]; // Remove duplicados
            let html = `<h2>üõí Ingredientes de Hoje</h2><p>Itens necess√°rios para preparar as refei√ß√µes de <b>${dNome}</b>:</p><ul class="ingredientes-list">`;
            listaUnica.forEach(i => html += `<li>${i}</li>`);
            container.innerHTML = html + `</ul>`;
        } else if (aba === 'semana') {
            container.innerHTML = `<p>Consulte a vis√£o semanal completa no modo Tabela.</p>`;
        }
    }
};
window.onload = () => app.mudarAba('dia');
</script>
</body>
</html>
